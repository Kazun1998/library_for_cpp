---
title: 第 II 種 Stirling 数
documentation_of: //Modulo_Polynomial/Stirling_2nd.hpp
---

## Outline

第 II 種 Stirling 数 $S^{(2)}_{n,k}$ を求める.

## Define

第 II 種 Stirling 数 $S^{(2)}_{n,k}$ とは, 以下の展開係数として定義される.

$$ x^n = \sum_{k=0}^n S^{(2)}_{n,k} \cdot x(x-1)\cdots(x-(n-1))$$

## Theory

### 漸化式としての特徴づけ
第 II 種 Stirling 数 $S^{(2)}_{n,k}$ について, 以下が成り立つ.

$$ S^{(2)}_{n,k} = S^{(2)}_{n-1,k-1} + k S^{(1)}_{n-1,k} \quad (n \geq 1, 0 \leq k \leq n) $$

### 組み合わせ理論による特徴づけ
$S^{(2)}_{n, k}$ について, 以下が成り立つ.

> $\{1, 2, \dots, n\}$ を $k$ 個の部分集合に分割する方法の数は $S^{(2)}_{n,k}$ である.

#### 証明

$I_n := \{1, 2, \dots, n\}$ を $k$ 個の部分集合に分割する方法 $T_{n,k}$ を以下のようにして場合分けして求める.

##### $n$ のみ独立させた集合を形成させる場合

残りは $I_{n-1}$ を $(k-1)$ 個の部分集合に分割させる方法である. これは $T_{n-1,k-1}$ 通りである.

##### $n$ を既存の部分集合に含ませる場合

$I_{n-1}$ の $k$ 個の部分集合への分割 $J_1, \dots, J_k$ それぞれに対して, $n$ を $J_1, \dots, J_k$ をどこに分割させるかが $k$ 通りである.

$J_1, \dots, J_k$ の選び方が $T_{n - 1, k}$ 通りである.

よって, 合計 $k T_{n-1,k}$ 個である.

以上を合計して,

$$ T_{n,k} = T_{n-1,k-1} + k T_{n-1,k} $$

である.

この漸化式は, $S^{(2)}\_{n,k}$ と一致する. また, $T\_{0, 0} = 1$ であるため, $T\_{n,k} = S^{(2)}\_{n,k}$ となる.

$\square$

### 第 II 種 Stirling 数の明示的表示

包除原理によって求めることができる. まず, 以下は $1$ 対 $k!$ 対応する.

* $I_n$ の $k$ 個の部分集合への分割.
* $I_n$ から $I_k$ への全射の数.

$I_n$ から $I_k$ への全射の数を包除原理を使って考える. $I_n$ から, $I_k$ の部分集合のうち, 固定された $m$ 要素の集合への写像の数は $m^n$ 個である.

$I_k$ の部分集合のうち, $m$ 要素の集合は $\binom{n}{m}$ 個である.

故に, 包除原理によって,

$$ k! S^{(2)}_{n,k} = \sum_{m=0}^k (-1)^{k-m} \binom{k}{m} m^n $$

であるため,

$$ S^{(2)}_{n,k} = \dfrac{1}{k!} \sum_{m=0}^k (-1)^{k-m} \binom{k}{m} m^n $$

となる.

### 畳み込みを用いた, 第 II 種 Stirling 数を求めるアルゴリズム

第 II 種 Stirling 数の明示的表示から, $S^{(2)}\_{n,0}, S^{(2)}\_{n,1}, \dots, S^{(2)}\_{n, n}$ を高速に求めることができる.

第 II 種 Stirling 数の明示的表示を更に変形させると,

$$ S^{(2)}_{n, k} = \sum_{m=0}^k \dfrac{m^n}{m!} \cdot \dfrac{(-1)^{k-m}}{(k-m)!} $$

そのため, $n$ 次の多項式 $P, Q$ を

$$ P := \sum_{d=0}^n \dfrac{d^n}{d!} X^d, \quad Q := \sum_{d=0}^n \dfrac{(-1)^d}{d!} X^d $$

とすると, $S^{(2)}_{n,k} = \left[X^k \right] PQ$ である.

そのため, $S^{(2)}\_{n,0}, S^{(2)}\_{n,1}, \dots, S^{(2)}\_{n, n}$ は $O(n \log n)$ 時間で求められる.

## Contents

```cpp
vector<mint> Stirling_2nd(int N)
```

* 第 II 種 Stirling 数 $S^{(2)}\_{N,0}, S^{(2)}\_{N,1}, \dots, S^{(2)}\_{N,N}$ を求める.
* **計算量** : $O(N \log N)$ 時間.

